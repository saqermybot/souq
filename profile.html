<!doctype html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>ุงูููู ุงูุดุฎุตู โข Souq Syria</title>

  <link rel="stylesheet" href="./base.css">
  <link rel="stylesheet" href="./components.css">

  <script>
    document.documentElement.setAttribute("data-theme", "dark");
  </script>
</head>
<body>

  <header class="topbar">
    <div class="brand">
      <span class="dot"></span>
      Souq Syria
    </div>

    <div class="authbar" style="gap:10px">
      <a href="./index.html" class="ghostLink" aria-label="ุงูุฑุฌูุน ููุณูู">ุงูุฑุฌูุน ููุณูู</a>
    </div>
  </header>

  <main class="container">
    <section class="deluxeFilters" style="margin-top:12px">

      <!-- โ ุฃุฒุฑุงุฑ ุจุณูุทุฉ ููุงุถุญุฉ -->
      <div class="profileTopActions">
        <button id="btnSharePage" class="secondary sm" type="button">๐ ูุดุงุฑูุฉ ุงูุตูุญุฉ</button>
      </div>

      <div class="filterHead">
        <div class="filterTitle">ุงูููู ุงูุดุฎุตู</div>
        <div id="pStatus" class="muted small"></div>
      </div>

      <div class="formGrid">
        <div class="field span2" style="display:flex; align-items:center; gap:10px;">
          <div id="pAvatar" class="inboxAvatar" style="width:64px;height:64px;border-radius:18px; font-size:20px;">U</div>
          <div style="min-width:0">
            <div id="pEmail" class="muted small" style="margin-bottom:6px; word-break:break-all;"></div>
            <div class="muted small">ุนุฏูู ูุนูููุงุชู ูุชุธูุฑ ูุชุงุฌุฑ/ุจุงุฆุน ูููุงุณ.</div>
          </div>
        </div>

        <div class="field span2">
          <label class="flabel">ุงุณู ุงูุนุฑุถ (ูุธูุฑ ูููุงุณ)</label>
          <input id="displayName" placeholder="ูุซุงู: ุฃุจู ุฃุญูุฏ - ุณูุงุฑุงุช ุฏูุดู" />
        </div>

        <div class="field span2">
          <label class="flabel">ุฑุงุจุท ุตูุฑุฉ ุงูุจุฑููุงูู (ุงุฎุชูุงุฑู)</label>
          <input id="photoURL" placeholder="https://..." />
          <div class="muted small">ุฅุฐุง ุชุฑูุชู ูุงุฑุบุ ูุณุชุฎุฏู ุตูุฑุฉ Google/ุงูุญุฑู.</div>
        </div>

        <div class="field">
          <label class="flabel">ุงููุฏููุฉ (ุงุฎุชูุงุฑู)</label>
          <input id="city" placeholder="ูุซุงู: ุฏูุดู" />
        </div>

        <div class="field">
          <label class="flabel">ูุงุชุณุงุจ (ุงุฎุชูุงุฑู)</label>
          <input id="whatsapp" placeholder="ูุซุงู: +9639xxxxxxxx ุฃู 0031xxxxxxxx" inputmode="tel" />
        </div>

        <div class="field span2">
          <label class="flabel">ูุจุฐุฉ ูุตูุฑุฉ (ุงุฎุชูุงุฑู)</label>
          <textarea id="bio" rows="3" placeholder="ูุซุงู: ุชุฌุงุฑุฉ ุณูุงุฑุงุช ูุณุชุนููุฉ - ุชูุตูู ุฏุงุฎู ุณูุฑูุง"></textarea>
        </div>

        <div class="field span2 actionsGrid">
          <button id="btnSave" class="primary" type="button">ุญูุธ</button>
          <button id="btnMyStore" class="secondary" type="button">ุฅุนูุงูุงุชู</button>
        </div>

        <div class="field span2">
          <button id="btnLogout" class="danger" type="button" style="width:100%; height:44px; border-radius:14px;">ุฎุฑูุฌ</button>
        </div>
      </div>
    </section>
  </main>

  <script type="module" src="./js/profile.js?v=2"></script>

  <!-- โ ููุทู ุงููุดุงุฑูุฉ (ุจุณูุท + ูุถููู) -->
  <script type="module">
    import { auth } from "./js/firebase.js";
    import { UI } from "./js/ui.js";

    const btnShare = document.getElementById("btnSharePage");

    if (btnShare) {
      btnShare.onclick = async () => {
        const user = auth.currentUser;
        if (!user) {
          UI.toast?.("ูุงุฒู ุชุณุฌู ุฏุฎูู ุฃููุงู") || alert("ูุงุฒู ุชุณุฌู ุฏุฎูู ุฃููุงู");
          return;
        }

        const name =
          document.getElementById("displayName")?.value ||
          user.displayName ||
          "ุชุงุฌุฑ ุณูู ุณูุฑูุง";

        const url = new URL("./store.html", location.href);
        url.searchParams.set("u", user.uid);

        try {
          if (navigator.share) {
            await navigator.share({
              title: name,
              text: `ุดุงูุฏ ุฅุนูุงูุงุช ${name} ุนูู ุณูู ุณูุฑูุง`,
              url: url.toString()
            });
          } else {
            await navigator.clipboard.writeText(url.toString());
            UI.toast?.("ุชู ูุณุฎ ุฑุงุจุท ุงูุตูุญุฉ ๐") || alert("ุชู ูุณุฎ ุฑุงุจุท ุงูุตูุญุฉ");
          }
        } catch {}
      };
    }
  </script>

  <style>
    .ghostLink{
      display:inline-flex;
      align-items:center;
      justify-content:center;
      padding:10px 14px;
      border-radius:12px;
      border:1px solid var(--border);
      color:var(--text);
      text-decoration:none;
      background:transparent;
      font-size:16px;
      white-space:nowrap;
    }
    .ghostLink:active{ transform: scale(.98); }

    .profileTopActions{
      display:flex;
      gap:8px;
      margin-bottom:10px;
    }
    .profileTopActions .sm{
      height:36px;
      padding:0 12px;
      border-radius:12px;
      font-size:13px;
      white-space:nowrap;
    }
  </style>

  <!-- ACCOUNT MODAL (Upgrade / Recover) -->
  <div id="accountModal" class="modal hidden">
    <div class="modalCard">
      <div class="modalHead">
        <div style="font-weight:900">ุญุณุงุจู (ุจุฏูู ุชูุซูู)</div>
        <button id="btnCloseAccount" class="ghost" type="button">ุฅุบูุงู</button>
      </div>

      <div class="tabsRow">
        <button id="accTabUpgrade" class="tabBtn active" type="button">ุชุฑููุฉ ูุญุณุงุจ</button>
        <button id="accTabRecover" class="tabBtn" type="button">ุงุณุชุฑุฌุงุน ุญุณุงุจ</button>
      </div>

      <div id="accPaneUpgrade">
        <div class="row" style="margin-top:10px">
          <input id="accDisplayName" placeholder="ุงุณูู / ุงุณู ุงููุชุฌุฑ" autocomplete="name" />
        </div>
        <div class="row" style="margin-top:10px">
          <input id="accContact" placeholder="ุฑูู ูุงุชู ุฃู ุฅูููู (ููุงุณุชุฑุฌุงุน)" autocomplete="email" />
        </div>
        <div class="row" style="margin-top:10px">
          <input id="accPin" placeholder="PIN (5 ุฃุฑูุงู ุฃู ุฃูุซุฑ)" inputmode="numeric" autocomplete="one-time-code" />
        </div>
        <div class="row" style="margin-top:12px">
          <button id="btnDoUpgrade" class="primary" type="button">ุฅูุดุงุก ุงูุญุณุงุจ</button>
        </div>
        <p class="muted small" style="margin-top:10px">
          ููุงุญุธุฉ: ุจุฏูู ุชูุซูู. ุฅุฐุง ูุณุญุช ุงููุชุตูุญุ ุจุชุณุชุฑุฌุน ุญุณุงุจู ุนุจุฑ (ุงููุงุชู/ุงูุฅูููู + PIN).
        </p>
      </div>

      <div id="accPaneRecover" style="display:none">
        <div class="row" style="margin-top:10px">
          <input id="recIdentifier" placeholder="ุฑูู ูุงุชู ุฃู ุฅูููู ุฃู ุงุณู ุงููุชุฌุฑ" autocomplete="username" />
        </div>
        <div class="row" style="margin-top:10px">
          <input id="recPin" placeholder="PIN" inputmode="numeric" autocomplete="current-password" />
        </div>
        <div class="row" style="margin-top:12px">
          <button id="btnDoRecover" class="primary" type="button">ุงุณุชุฑุฌุงุน</button>
        </div>
      </div>
    </div>
  </div>

</body>
</html>